"use strict";var app=function(){var appName="Receptář",appVersion="23.04.02.123310",appOwner="Tomáš 'Stínolez' Vitásek",loader=document.querySelector(".loader");function createElement(elementType,data){let element=document.createElement(elementType),attributes=JSON.parse(data[1]);switch(elementType){case"div":case"span":case"h2":case"p":case"tr":case"td":case"li":case"img":element.className=data[0],element.innerHTML=data[2];for(let attr in attributes)-1===attr.indexOf("data-")?element[attr]=attributes[attr]:element.dataset[attr.replace("data-","")]=attributes[attr];break;case"ul":case"ol":let listData=data[2];element.className=data[0];for(let attr in attributes)-1===attr.indexOf("data-")?element[attr]=attributes[attr]:element.dataset[attr.replace("data-","")]=attributes[attr];for(let i=0;i<listData.length;i++){let sub=createElement("li",listData[i]);element.appendChild(sub)}}return element}function showLoader(){loader.hidden=!1}function hideLoader(){loader.hidden=!0}function loadJSON(callback,filepath){var xobj=new XMLHttpRequest;xobj.overrideMimeType("application/json"),xobj.open("GET",filepath,!0),xobj.onreadystatechange=function(){4==xobj.readyState&&"200"==xobj.status&&callback(xobj.responseText)},xobj.send(null)}function comparable(str){return str.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}function sortByKey(array,key){return array.sort((function(a,b){let x=comparable(a[key]),y=comparable(b[key]);return x<y?-1:x>y?1:0}))}function registerRecipes(json){let data=JSON.parse(json).data,recipes=document.getElementById("recipes");data=sortByKey(data,"name");for(let i=0;i<data.length;i++){let name=data[i].name,tags=comparable(name+"|"+data[i].tags.join("|")),uid=data[i].uid,image,d_attr={"data-tags":tags,"data-uid":uid},i_attr={src:"../images/"+(data[i].image?"data/"+uid+".png":"system/no-image.png")},recipe=createElement("div",["recipe",JSON.stringify(d_attr),""]),title=createElement("div",["recipe-title","{}",name]),img=createElement("img",["recipe-image",JSON.stringify(i_attr),""]);recipe.appendChild(img),recipe.appendChild(title),recipes.appendChild(recipe)}if(document.getElementsByClassName("recipe").length>0)for(let i=0;i<document.getElementsByClassName("recipe").length;i++)document.getElementsByClassName("recipe")[i].addEventListener("click",(function(e){location.href="recipe.html?uid="+e.target.parentNode.dataset.uid}))}function registerRecipe(json){let data=JSON.parse(json),recipe=document.getElementById("recipe");document.getElementsByTagName("h1")[0].innerText=data.name;for(let i=0;i<data.ingredients.length;i++){let name=data.ingredients[i].name,ingredients=[];for(let j=0;j<data.ingredients[i].data.length;j++)ingredients.push(["","{}",data.ingredients[i].data[j]]);let div=createElement("div",["ingredients","{}",""]),header=createElement("h2",["","{}",name]),list=createElement("ul",["","{}",ingredients]);div.appendChild(header),div.appendChild(list),recipe.appendChild(div)}for(let i=0;i<data.steps.length;i++){let name=data.steps[i].name,steps=[];for(let j=0;j<data.steps[i].data.length;j++)steps.push(["","{}",data.steps[i].data[j]]);let div=createElement("div",["steps","{}",""]),header=createElement("h2",["","{}",name]),list=createElement("ol",["","{}",steps]);div.appendChild(header),div.appendChild(list),recipe.appendChild(div)}let notes_div=createElement("div",["notes","{}",""]),notes_header=createElement("h2",["","{}","Poznámky"]);notes_div.appendChild(notes_header);for(let i=0;i<data.notes.length;i++){let notes_data=createElement("p",["","{}",data.notes[i]]);notes_div.appendChild(notes_data)}data.notes.length>0&&recipe.appendChild(notes_div)}return{getAppName:function(){return appName},getAppVersion:function(){return appVersion},getAppOwner:function(){return appOwner},createElement:function(elementType,data){return createElement(elementType,data)},setLoading:function(bool){bool?showLoader():hideLoader()},init:function(){if(showLoader(),document.getElementById("copyright").innerHTML=app.getAppName()+", v."+app.getAppVersion()+", &copy; "+app.getAppOwner()+", "+(new Date).getFullYear(),document.getElementById("headerBack")&&document.getElementById("headerBack").addEventListener("click",(function(e){location.href=e.target.dataset.url})),document.getElementById("headerRefresh")&&document.getElementById("headerRefresh").addEventListener("click",(function(e){location.reload()})),document.getElementById("headerSearch")&&document.getElementById("headerSearch").addEventListener("click",(function(e){let title=document.getElementsByClassName("headerTitle")[0].style.display||"block",search=document.getElementsByClassName("headerSearchBox")[0].style.display||"none";document.getElementsByClassName("headerTitle")[0].style.display="block"===title?"none":"block",document.getElementsByClassName("headerSearchBox")[0].style.display="flex"===search?"none":"flex","flex"===document.getElementsByClassName("headerSearchBox")[0].style.display?document.getElementById("recipeSearch").focus():(document.getElementById("recipeSearch").value="",document.getElementById("recipeSearch").dispatchEvent(new KeyboardEvent("keyup",{keyCode:70,ctrlKey:!0})))})),document.getElementById("recipeSearch")&&document.getElementById("recipeSearch").addEventListener("keyup",(function(e){let search=comparable(document.getElementById("recipeSearch").value);if(""!==search)for(let i=0;i<document.getElementsByClassName("recipe").length;i++){let tags,matches;0===document.getElementsByClassName("recipe")[i].dataset.tags.split("|").filter(s=>s.includes(search)).length?document.getElementsByClassName("recipe")[i].style.display="none":document.getElementsByClassName("recipe")[i].style.display="block"}else for(let i=0;i<document.getElementsByClassName("recipe").length;i++)document.getElementsByClassName("recipe")[i].style.display="block"})),document.getElementById("recipes")&&loadJSON(registerRecipes,"../data/_main.json"),document.getElementById("recipe")){const queryString=window.location.search,urlParams=new URLSearchParams(queryString);loadJSON(registerRecipe,"../data/"+urlParams.get("uid")+".json")}hideLoader()}}}();app.init();
//# sourceMappingURL=app.min.js.map