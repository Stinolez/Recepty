"use strict";var app=function(){var appName="Receptář - Přidat recept",appOwner="Tomáš 'Stínolez' Vitásek",loader=document.querySelector(".loader");function showLoader(){loader.hidden=!1}function hideLoader(){loader.hidden=!0}function loadJSON(callback,filepath){var xobj=new XMLHttpRequest;xobj.overrideMimeType("application/json"),xobj.open("GET",filepath,!0),xobj.onreadystatechange=function(){4==xobj.readyState&&"200"==xobj.status&&callback(xobj.responseText)},xobj.send(null)}function comparable(str){return str.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}function sortByKey(array,key){return array.sort((function(a,b){let x=comparable(a[key]),y=comparable(b[key]);return x<y?-1:x>y?1:0}))}function trimArray(array){let arr;return array.map(element=>element.trim()).filter(elm=>elm)}function mainJSON(json){let data=JSON.parse(json).data,maxID="",tags=[],tags_list=[],tag_cloud=document.getElementById("tag-cloud");data=sortByKey(data,"uid"),maxID=data[data.length-1].uid||"0";for(let i=0;i<data.length;i++)tags.push.apply(tags,data[i].tags);document.getElementById("uid").value=("00000"+(Number(maxID)+1)).slice(-5);let occurrences=tags.reduce((function(acc,curr){return acc[curr]?++acc[curr]:acc[curr]=1,acc}),{});for(let key in occurrences)tags_list.push({name:key,value:occurrences[key]});tags_list=sortByKey(tags_list,"name");for(let i=0;i<tags_list.length;i++){let span=document.createElement("span");span.innerText=tags_list[i].name,span.classList="tag-cloud-detail",span.dataset.occurences=tags_list[i].value,span.style.fontSize=.7+tags_list[i].value/20+"rem",tag_cloud.appendChild(span)}}function generateJSON(){let main={},main_container=document.getElementById("main_json"),recipe={},recipe_container=document.getElementById("recipe_json"),ingredients_group=document.getElementsByClassName("ingredients-group"),step_group=document.getElementsByClassName("recipe-group"),notes_group=document.getElementsByClassName("notes-group-item");main.name=document.getElementById("recipe-name").value||"",main.uid=document.getElementById("uid").value||"",main.image=!0,main.tags=document.getElementById("tags").value.split(",")||[],main.tags=trimArray(main.tags),recipe.name=document.getElementById("recipe-name").value||"",recipe.ingredients=[];for(let i=0;i<ingredients_group.length;i++){let ingredients={};ingredients.name=ingredients_group[i].getElementsByClassName("ingredients-group-name")[0].value,ingredients.data=[];let ingredients_items=ingredients_group[i].getElementsByClassName("ingredients-group-item");for(let j=0;j<ingredients_items.length;j++)""!=ingredients_items[j].value&&ingredients.data.push(ingredients_items[j].value);recipe.ingredients.push(ingredients)}recipe.steps=[];for(let i=0;i<step_group.length;i++){let step={};step.name=step_group[i].getElementsByClassName("recipe-group-name")[0].value,step.data=[];let step_items=step_group[i].getElementsByClassName("recipe-group-item");for(let j=0;j<step_items.length;j++)""!=step_items[j].value&&step.data.push(step_items[j].value);recipe.steps.push(step)}recipe.notes=[];for(let i=0;i<notes_group.length;i++)""!=notes_group[i].value&&recipe.notes.push(notes_group[i].value);main_container.innerText=", "+JSON.stringify(main),recipe_container.innerText=JSON.stringify(recipe)}return{getAppName:function(){return appName},getAppOwner:function(){return appOwner},setLoading:function(bool){bool?showLoader():hideLoader()},init:function(){showLoader(),loadJSON(mainJSON,"../data/_main.json"),document.getElementsByClassName("add-ingredient-item")[0].addEventListener("click",(function(e){let input=document.createElement("input");input.type="text",input.name="ingredients-group-item",input.classList="ingredients-group-item",e.target.before(input)})),document.getElementsByClassName("add-ingredient-group")[0].addEventListener("click",(function(e){let section=document.createElement("section"),label_name=document.createElement("label"),input_name=document.createElement("input"),label_item=document.createElement("label"),input_item=document.createElement("input"),button=document.createElement("button");section.classList="ingredients-group",label_name.htmlFor="ingredients-group-name",label_name.innerText="Název skupiny:",input_name.type="text",input_name.name="ingredients-group-name",input_name.classList="ingredients-group-name",label_item.htmlFor="ingredients-group-item",label_item.innerText="Ingredience:",input_item.type="text",input_item.name="ingredients-group-item",input_item.classList="ingredients-group-item",button.classList="add-ingredient-item",button.innerText="Přidat ingredienci",button.addEventListener("click",(function(e){let input=document.createElement("input");input.type="text",input.name="ingredients-group-item",input.classList="ingredients-group-item",e.target.before(input)})),section.appendChild(label_name),section.appendChild(input_name),section.appendChild(label_item),section.appendChild(input_item),section.appendChild(button),e.target.before(section)})),document.getElementsByClassName("add-recipe-item")[0].addEventListener("click",(function(e){let textarea=document.createElement("textarea");textarea.rows="2",textarea.name="recipe-group-item",textarea.classList="recipe-group-item",e.target.before(textarea)})),document.getElementsByClassName("add-recipe-group")[0].addEventListener("click",(function(e){let section=document.createElement("section"),label_name=document.createElement("label"),input_name=document.createElement("input"),label_item=document.createElement("label"),area_item=document.createElement("textarea"),button=document.createElement("button");section.classList="recipe-group",label_name.htmlFor="recipe-group-name",label_name.innerText="Název skupiny:",input_name.type="text",input_name.name="recipe-group-name",input_name.classList="recipe-group-name",label_item.htmlFor="recipe-group-item",label_item.innerText="Krok:",area_item.name="recipe-group-item",area_item.classList="recipe-group-item",area_item.rows="2",button.classList="add-recipe-item",button.innerText="Přidat krok",button.addEventListener("click",(function(e){let textarea=document.createElement("textarea");textarea.rows="2",textarea.name="recipe-group-item",textarea.classList="recipe-group-item",e.target.before(textarea)})),section.appendChild(label_name),section.appendChild(input_name),section.appendChild(label_item),section.appendChild(area_item),section.appendChild(button),e.target.before(section)})),document.getElementsByClassName("add-notes-item")[0].addEventListener("click",(function(e){let input=document.createElement("input");input.type="text",input.name="notes-group-item",input.classList="notes-group-item",e.target.before(input)})),document.getElementById("generate").addEventListener("click",(function(e){generateJSON()})),document.getElementById("copyright").innerHTML=app.getAppName()+", &copy; "+app.getAppOwner()+", "+(new Date).getFullYear(),hideLoader()}}}();app.init();
//# sourceMappingURL=add_recipe.min.js.map